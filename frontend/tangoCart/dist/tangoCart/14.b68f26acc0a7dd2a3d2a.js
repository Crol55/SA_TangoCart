(self.webpackChunktango_cart=self.webpackChunktango_cart||[]).push([[14],{1014:(t,i,e)=>{"use strict";e.r(i),e.d(i,{SubastaModule:()=>et});var a=e(8583),r=e(4655),s=e(7716),o=e(6893),n=e(7055),c=e(1904);const l=function(t){return{categoria:t}};function d(t,i){if(1&t&&(s.TgZ(0,"a",4),s._uU(1),s.qZA()),2&t){const t=i.$implicit,e=s.oxw();s.ekj("active",e.categoria===t.nombre),s.Q6J("queryParams",s.VKq(4,l,t.nombre)),s.xp6(1),s.hij(" ",t.nombre," ")}}let u=(()=>{class t{constructor(t){this.categoriaService=t,this.categories$=this.categoriaService.getCategories()}ngOnInit(){}}return t.\u0275fac=function(i){return new(i||t)(s.Y36(n.n))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-filtro"]],inputs:{categoria:"categoria"},decls:6,vars:5,consts:[[1,"sticky-top"],[1,"list-group"],["routerLink","/auction",1,"list-group-item","list-group-item-action"],["routerLink","/auction","class","list-group-item list-group-item-action ",3,"queryParams","active",4,"ngFor","ngForOf"],["routerLink","/auction",1,"list-group-item","list-group-item-action",3,"queryParams"]],template:function(t,i){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"a",2),s._uU(3,"All Categories"),s.qZA(),s.YNc(4,d,2,6,"a",3),s.ALo(5,"async"),s.qZA(),s.qZA()),2&t&&(s.xp6(2),s.ekj("active",!i.categoria),s.xp6(2),s.Q6J("ngForOf",s.lcZ(5,3,i.categories$)))},directives:[r.yS,a.sg],pipes:[a.Ov],styles:[".sticky-top[_ngcontent-%COMP%]{top:80px}"]}),t})();var p=e(5029),h=e(2238);function g(t,i){if(1&t&&s._UZ(0,"img",9),2&t){const t=s.oxw(2);s.s9C("alt",t.subasta.products.foto),s.Q6J("src",t.subasta.products.foto,s.LSH)}}function m(t,i){if(1&t){const t=s.EpF();s.TgZ(0,"div",1),s.YNc(1,g,1,2,"img",2),s.TgZ(2,"div",3),s.TgZ(3,"h5",4),s.TgZ(4,"b"),s._uU(5),s.qZA(),s.qZA(),s.TgZ(6,"h5",4),s._uU(7),s.qZA(),s.TgZ(8,"p",5),s._uU(9),s.ALo(10,"currency"),s.qZA(),s.qZA(),s.TgZ(11,"div",6),s.TgZ(12,"div",7),s.TgZ(13,"button",8),s.NdJ("click",function(){return s.CHM(t),s.oxw().ofertar()}),s._uU(14,"Ofertar"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",t.subasta.products.foto),s.xp6(4),s.AsE("",t.subasta.products.nombre," ",t.comprobar(t.subasta.usuarios._id),""),s.xp6(2),s.hij("Finaliza: ",t.comprobarfecha(),""),s.xp6(2),s.Oqu(s.xi3(10,5,t.subasta.oferta,"USD"))}}let f=(()=>{class t{constructor(t,i,e){this.dialog=t,this.auth=i,this.router=e,this.cantidad=1}ngOnInit(){}comprobarfecha(){return new Date<new Date(this.subasta.fecha_final)?`${new Date(this.subasta.fecha_final).toLocaleString()}`:"La subasta ya finaliz\xf3!"}formatAMPM(t){var i=t.getHours(),e=t.getMinutes(),a=i>=12?"pm":"am";return(i=(i%=12)||12)+":"+(e=e<10?"0"+e:e)+" "+a}ofertar(){this.router.navigate(["/auction","producto"],{queryParams:{_id:this.subasta._id}})}openDialog(t){this.dialog.open(p.a,{data:{message:t}}).afterClosed()}comprobar(t){return t==this.auth.currentUser[0]._id?"\u2705":""}}return t.\u0275fac=function(i){return new(i||t)(s.Y36(h.uw),s.Y36(o.e),s.Y36(r.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-detalle"]],inputs:{subasta:"subasta"},decls:1,vars:1,consts:[["class","card","style","width: 18rem;",4,"ngIf"],[1,"card",2,"width","18rem"],["class","card-img-top",3,"src","alt",4,"ngIf"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"card-footer"],[1,"d-grid","gap-2"],[1,"btn","btn-primary",3,"click"],[1,"card-img-top",3,"src","alt"]],template:function(t,i){1&t&&s.YNc(0,m,15,8,"div",0),2&t&&s.Q6J("ngIf",i.subasta.products.nombre)},directives:[a.O5],pipes:[a.H9],styles:[".card[_ngcontent-%COMP%]{margin-bottom:30px}.card-footer[_ngcontent-%COMP%]{padding:0}"]}),t})();function b(t,i){1&t&&s._UZ(0,"div",7)}function _(t,i){if(1&t&&(s.ynx(0),s.TgZ(1,"div",3),s._UZ(2,"app-detalle",5),s.qZA(),s.YNc(3,b,1,0,"div",6),s.BQk()),2&t){const t=i.$implicit,e=i.index;s.xp6(2),s.Q6J("subasta",t),s.xp6(1),s.Q6J("ngIf",(e+1)%2==0)}}let x=(()=>{class t{constructor(t,i,e,a){this.auth=t,this.route=i,this.categoriaService=e,this.subastaService=a,this.subastas=[],this.filteredAuctions=[],this.subastaService.getSubastas().subscribe(t=>{this.subastas=t,i.queryParamMap.subscribe(t=>{this.categoria=t.get("categoria"),this.filteredAuctions=this.categoria?this.subastas.filter(t=>t.products.categorias==this.categoria):this.subastas})})}ngOnInit(){}}return t.\u0275fac=function(i){return new(i||t)(s.Y36(o.e),s.Y36(r.gz),s.Y36(n.n),s.Y36(c.q))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-home"]],decls:6,vars:2,consts:[[1,"row"],[1,"col-3"],[3,"categoria"],[1,"col"],[4,"ngFor","ngForOf"],[3,"subasta"],["class","w-100",4,"ngIf"],[1,"w-100"]],template:function(t,i){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"app-filtro",2),s.qZA(),s.TgZ(3,"div",3),s.TgZ(4,"div",0),s.YNc(5,_,4,2,"ng-container",4),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(2),s.Q6J("categoria",i.categoria),s.xp6(3),s.Q6J("ngForOf",i.filteredAuctions))},directives:[u,a.sg,f,a.O5],styles:[".sticky-top[_ngcontent-%COMP%]{top:80px}"]}),t})();var w=e(6304),Z=e(3679),v=e(7001),y=e(6237),S=e(2458);const T=["*",[["mat-card-footer"]]],A=["*","mat-card-footer"];let q=(()=>{class t{constructor(t){this._animationMode=t}}return t.\u0275fac=function(i){return new(i||t)(s.Y36(y.Qb,8))},t.\u0275cmp=s.Xpm({type:t,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,i){2&t&&s.ekj("_mat-animation-noopable","NoopAnimations"===i._animationMode)},exportAs:["matCard"],ngContentSelectors:A,decls:2,vars:0,template:function(t,i){1&t&&(s.F$t(T),s.Hsn(0),s.Hsn(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}\n"],encapsulation:2,changeDetection:0}),t})(),k=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[S.BQ],S.BQ]}),t})();var I=e(9490),U=e(946);const C=["*"],z=".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}\n";class J{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const t=Math.max(...this.tracker);return t>1?this.rowCount+t-1:this.rowCount}update(t,i){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(t),this.tracker.fill(0,0,this.tracker.length),this.positions=i.map(t=>this._trackTile(t))}_trackTile(t){const i=this._findMatchingGap(t.colspan);return this._markTilePosition(i,t),this.columnIndex=i+t.colspan,new H(this.rowIndex,i)}_findMatchingGap(t){let i=-1,e=-1;do{this.columnIndex+t>this.tracker.length?(this._nextRow(),i=this.tracker.indexOf(0,this.columnIndex),e=this._findGapEndIndex(i)):(i=this.tracker.indexOf(0,this.columnIndex),-1!=i?(e=this._findGapEndIndex(i),this.columnIndex=i+1):(this._nextRow(),i=this.tracker.indexOf(0,this.columnIndex),e=this._findGapEndIndex(i)))}while(e-i<t||0==e);return Math.max(i,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let t=0;t<this.tracker.length;t++)this.tracker[t]=Math.max(0,this.tracker[t]-1)}_findGapEndIndex(t){for(let i=t+1;i<this.tracker.length;i++)if(0!=this.tracker[i])return i;return this.tracker.length}_markTilePosition(t,i){for(let e=0;e<i.colspan;e++)this.tracker[t+e]=i.rowspan}}class H{constructor(t,i){this.row=t,this.col=i}}const O=new s.OlP("MAT_GRID_LIST");let $=(()=>{class t{constructor(t,i){this._element=t,this._gridList=i,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(t){this._rowspan=Math.round((0,I.su)(t))}get colspan(){return this._colspan}set colspan(t){this._colspan=Math.round((0,I.su)(t))}_setStyle(t,i){this._element.nativeElement.style[t]=i}}return t.\u0275fac=function(i){return new(i||t)(s.Y36(s.SBq),s.Y36(O,8))},t.\u0275cmp=s.Xpm({type:t,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(t,i){2&t&&s.uIk("rowspan",i.rowspan)("colspan",i.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:C,decls:2,vars:0,consts:[[1,"mat-grid-tile-content"]],template:function(t,i){1&t&&(s.F$t(),s.TgZ(0,"div",0),s.Hsn(1),s.qZA())},styles:[z],encapsulation:2,changeDetection:0}),t})();const Q=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class M{constructor(){this._rows=0,this._rowspan=0}init(t,i,e,a){this._gutterSize=R(t),this._rows=i.rowCount,this._rowspan=i.rowspan,this._cols=e,this._direction=a}getBaseTileSize(t,i){return`(${t}% - (${this._gutterSize} * ${i}))`}getTilePosition(t,i){return 0===i?"0":E(`(${t} + ${this._gutterSize}) * ${i}`)}getTileSize(t,i){return`(${t} * ${i}) + (${i-1} * ${this._gutterSize})`}setStyle(t,i,e){let a=100/this._cols,r=(this._cols-1)/this._cols;this.setColStyles(t,e,a,r),this.setRowStyles(t,i,a,r)}setColStyles(t,i,e,a){let r=this.getBaseTileSize(e,a);t._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(r,i)),t._setStyle("width",E(this.getTileSize(r,t.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(t){return`${this._rowspan} * ${this.getTileSize(t,1)}`}getComputedHeight(){return null}}class Y extends M{constructor(t){super(),this.fixedRowHeight=t}init(t,i,e,a){super.init(t,i,e,a),this.fixedRowHeight=R(this.fixedRowHeight),Q.test(this.fixedRowHeight)}setRowStyles(t,i){t._setStyle("top",this.getTilePosition(this.fixedRowHeight,i)),t._setStyle("height",E(this.getTileSize(this.fixedRowHeight,t.rowspan)))}getComputedHeight(){return["height",E(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["height",null]),t._tiles&&t._tiles.forEach(t=>{t._setStyle("top",null),t._setStyle("height",null)})}}class P extends M{constructor(t){super(),this._parseRatio(t)}setRowStyles(t,i,e,a){this.baseTileHeight=this.getBaseTileSize(e/this.rowHeightRatio,a),t._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,i)),t._setStyle("paddingTop",E(this.getTileSize(this.baseTileHeight,t.rowspan)))}getComputedHeight(){return["paddingBottom",E(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["paddingBottom",null]),t._tiles.forEach(t=>{t._setStyle("marginTop",null),t._setStyle("paddingTop",null)})}_parseRatio(t){const i=t.split(":");this.rowHeightRatio=parseFloat(i[0])/parseFloat(i[1])}}class B extends M{setRowStyles(t,i){let e=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);t._setStyle("top",this.getTilePosition(e,i)),t._setStyle("height",E(this.getTileSize(e,t.rowspan)))}reset(t){t._tiles&&t._tiles.forEach(t=>{t._setStyle("top",null),t._setStyle("height",null)})}}function E(t){return`calc(${t})`}function R(t){return t.match(/([A-Za-z%]+)$/)?t:`${t}px`}let F=(()=>{class t{constructor(t,i){this._element=t,this._dir=i,this._gutter="1px"}get cols(){return this._cols}set cols(t){this._cols=Math.max(1,Math.round((0,I.su)(t)))}get gutterSize(){return this._gutter}set gutterSize(t){this._gutter=`${null==t?"":t}`}get rowHeight(){return this._rowHeight}set rowHeight(t){const i=`${null==t?"":t}`;i!==this._rowHeight&&(this._rowHeight=i,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(t){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===t?new B:t&&t.indexOf(":")>-1?new P(t):new Y(t)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new J);const t=this._tileCoordinator,i=this._tiles.filter(t=>!t._gridList||t._gridList===this),e=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,i),this._tileStyler.init(this.gutterSize,t,this.cols,e),i.forEach((i,e)=>{const a=t.positions[e];this._tileStyler.setStyle(i,a.row,a.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(t){t&&(this._element.nativeElement.style[t[0]]=t[1])}}return t.\u0275fac=function(i){return new(i||t)(s.Y36(s.SBq),s.Y36(U.Is,8))},t.\u0275cmp=s.Xpm({type:t,selectors:[["mat-grid-list"]],contentQueries:function(t,i,e){if(1&t&&s.Suo(e,$,5),2&t){let t;s.iGM(t=s.CRH())&&(i._tiles=t)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(t,i){2&t&&s.uIk("cols",i.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[s._Bn([{provide:O,useExisting:t}])],ngContentSelectors:C,decls:2,vars:0,template:function(t,i){1&t&&(s.F$t(),s.TgZ(0,"div"),s.Hsn(1),s.qZA())},styles:[z],encapsulation:2,changeDetection:0}),t})(),j=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[S.uc,S.BQ],S.uc,S.BQ]}),t})();var L=e(8295),N=e(1095),D=e(5167),G=e(2613);function X(t,i){if(1&t){const t=s.EpF();s.TgZ(0,"mat-grid-tile",9),s.TgZ(1,"button",16),s.NdJ("click",function(){return s.CHM(t),s.oxw().finalizar()}),s._uU(2,"Finalizar Orden"),s.qZA(),s.qZA()}2&t&&s.Q6J("colspan",2)("rowspan",1)}const V=".example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.example-radio-button[_ngcontent-%COMP%]{margin:5px}";let W=(()=>{class t{constructor(t,i,e,a,r){this.route=t,this.subastaService=i,this.auth=e,this._snackBar=a,this.dialog=r,this.estado=!1,this.finalizarCompra=!1,this.form=new Z.cw({oferta:new Z.NI("")}),this.name=new Z.NI("",[]),this.subasta={_id:"",propietario:{},usuarios:{},products:{_id:"",user:"",nombre:"",precio:0,descripcion:"",categorias:"",stock:0,foto:"",createdAt:""},estado:"",oferta:"",fecha_final:"",createdAt:"",__v:0},t.queryParamMap.subscribe(t=>{this._id=t.get("_id")}),this.subastaService.getSubasta(this._id).subscribe(t=>{this.subasta._id=t[0]._id,this.subasta.propietario=t[0].propietario,this.subasta.usuarios=t[0].usuarios,this.subasta.products=t[0].products,this.subasta.estado=t[0].estado,this.subasta.oferta=t[0].oferta,this.subasta.fecha_final=t[0].fecha_final,this.comprobarEstado(this.subasta.usuarios),this.calcular(this.subasta.fecha_final)})}ngOnInit(){}calcular(t){let i=new Date(t).getTime(),e=setInterval(()=>{var t=(new Date).getTime(),a=i-t,r=Math.floor(a/864e5),s=Math.floor(a%864e5/36e5),o=Math.floor(a%36e5/6e4),n=Math.floor(a%6e4/1e3);this.tiempoRestante=0==r&&s>0?`${s} h : ${o} m : ${n} s `:0==s&&o>0?`${o} m : ${n} s `:`${n} s `,a<0&&(clearInterval(e),this.tiempoRestante="La subasta finaliz\xf3!",this.mensajeFinal(this.subasta.usuarios),this.estado=!0,this.form.disable())})}comprobarEstado(t){this.ofertaP=t._id==this.auth.currentUser[0]._id?"Tienes la oferta principal!":""}mensajeFinal(t){t._id==this.auth.currentUser[0]._id&&(this.ofertaP="Felicidades, el producto es tuyo!",this.finalizarCompra=!0)}comprobarValor(t){return String(parseInt(t)+5)}devolverFecha(t){return String(new Date(t).toLocaleDateString()+" "+this.formatAMPM(new Date(t)))}formatAMPM(t){var i=t.getHours(),e=t.getMinutes(),a=i>=12?"pm":"am";return(i=(i%=12)||12)+":"+(e=e<10?"0"+e:e)+" "+a}ofertar(){this.subastaService.getSubasta(this._id).subscribe(t=>{this.comprobarEstado(t[0].usuarios),this.subasta.oferta=t[0].oferta,""==this.form.value.oferta?this._snackBar.open("Debe ingresar una oferta!","Ok",{duration:2e3}):parseInt(this.form.value.oferta)>=parseInt(this.subasta.oferta)+5?this.subastaService.putSubasta({_id:this.subasta._id,propietario:this.subasta.propietario._id,usuarios:this.auth.currentUser[0]._id,products:this.subasta.products._id,estado:this.subasta.estado,oferta:this.form.value.oferta,fecha_final:this.subasta.fecha_final}).subscribe(t=>{this.subastaService.getSubasta(this._id).subscribe(t=>{this.subasta._id=t[0]._id,this.subasta.propietario=t[0].propietario,this.subasta.usuarios=t[0].usuarios,this.subasta.products=t[0].products,this.subasta.estado=t[0].estado,this.subasta.oferta=t[0].oferta,this.subasta.fecha_final=t[0].fecha_final,this.comprobarEstado(this.subasta.usuarios)})}):this._snackBar.open("La oferta tiene que se mayor a $ "+(parseInt(this.subasta.oferta)+5),"Ok",{duration:2e3}),this.form.reset()})}finalizar(){this.dialog.open(K,{data:{producto:this.subasta.products,precio:this.subasta.oferta,subasta:this.subasta}})}}return t.\u0275fac=function(i){return new(i||t)(s.Y36(r.gz),s.Y36(c.q),s.Y36(o.e),s.Y36(v.ux),s.Y36(h.uw))},t.\u0275cmp=s.Xpm({type:t,selectors:[["subasta-producto"]],decls:43,vars:43,consts:[[1,"row"],[1,"col-3"],[3,"categoria"],[1,"col"],[2,"background-color","#E5E9EC"],[2,"color","#41463D",3,"formGroup"],["cols","4","rowHeight","28px"],["rowHeight","10px",3,"colspan","rowspan"],[1,"card-img-top",2,"border-radius","8px",3,"src"],[3,"colspan","rowspan"],[2,"position","absolute","left","22px"],[2,"position","absolute","left","133px"],["matInput","","type","number","formControlName","oferta",1,"form-control",2,"width","150px","border-radius","8px","position","absolute","left","22px"],["mat-raised-button","","color","primary",2,"width","100px","background-color","#212529","border-radius","8px","position","absolute","left","195px",3,"disabled","click"],[2,"position","absolute","left","5px"],[3,"colspan","rowspan",4,"ngIf"],["mat-raised-button","","color","primary",2,"width","150px","background-color","#212529","border-radius","8px","position","absolute","left","95px",3,"click"]],template:function(t,i){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"app-filtro",2),s.qZA(),s.TgZ(3,"div",3),s.TgZ(4,"div",0),s.TgZ(5,"mat-card",4),s.TgZ(6,"form",5),s.TgZ(7,"mat-grid-list",6),s.TgZ(8,"mat-grid-tile",7),s._UZ(9,"img",8),s.qZA(),s.TgZ(10,"mat-grid-tile",9),s._uU(11),s.qZA(),s.TgZ(12,"mat-grid-tile",9),s.TgZ(13,"mat-label",10),s._uU(14),s.qZA(),s.qZA(),s._UZ(15,"mat-grid-tile",9),s.TgZ(16,"mat-grid-tile",9),s.TgZ(17,"mat-label",10),s._uU(18),s.qZA(),s.qZA(),s.TgZ(19,"mat-grid-tile",9),s.TgZ(20,"mat-label",11),s._uU(21),s.qZA(),s.qZA(),s._UZ(22,"mat-grid-tile",9),s.TgZ(23,"mat-grid-tile",9),s.TgZ(24,"mat-label",10),s._uU(25),s.qZA(),s.qZA(),s._UZ(26,"mat-grid-tile",9),s.TgZ(27,"mat-grid-tile",9),s._UZ(28,"input",12),s.TgZ(29,"button",13),s.NdJ("click",function(){return i.ofertar()}),s._uU(30,"Ofertar"),s.qZA(),s.qZA(),s.TgZ(31,"mat-grid-tile",9),s.TgZ(32,"mat-label",10),s._uU(33),s.qZA(),s.qZA(),s._UZ(34,"mat-grid-tile",9),s.TgZ(35,"mat-grid-tile",9),s.TgZ(36,"mat-label",14),s._uU(37),s.qZA(),s.qZA(),s.YNc(38,X,3,2,"mat-grid-tile",15),s._UZ(39,"mat-grid-tile",9),s.TgZ(40,"mat-grid-tile",9),s.TgZ(41,"mat-label",14),s._uU(42),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(2),s.Q6J("categoria",i.categoria),s.xp6(4),s.Q6J("formGroup",i.form),s.xp6(2),s.Q6J("colspan",2)("rowspan",14),s.xp6(1),s.s9C("src",i.subasta.products.foto,s.LSH),s.xp6(1),s.Q6J("colspan",2)("rowspan",1),s.xp6(1),s.hij(" ",i.ofertaP," "),s.xp6(1),s.Q6J("colspan",2)("rowspan",2),s.xp6(2),s.hij("Producto: ",i.subasta.products.nombre,""),s.xp6(1),s.Q6J("colspan",2)("rowspan",1),s.xp6(1),s.Q6J("colspan",2)("rowspan",1),s.xp6(2),s.hij("Tiempo restante: ",i.tiempoRestante,""),s.xp6(1),s.Q6J("colspan",2)("rowspan",1),s.xp6(2),s.Oqu(i.devolverFecha(i.subasta.fecha_final)),s.xp6(1),s.Q6J("colspan",2)("rowspan",1),s.xp6(1),s.Q6J("colspan",2)("rowspan",2),s.xp6(2),s.hij("Oferta de subasta actual: $ ",i.subasta.oferta,""),s.xp6(1),s.Q6J("colspan",2)("rowspan",1),s.xp6(1),s.Q6J("colspan",2)("rowspan",2),s.xp6(2),s.Q6J("disabled",i.estado),s.xp6(2),s.Q6J("colspan",2)("rowspan",1),s.xp6(2),s.hij("Introduce : $ ",i.comprobarValor(i.subasta.oferta)," o m\xe1s"),s.xp6(1),s.Q6J("colspan",2)("rowspan",1),s.xp6(1),s.Q6J("colspan",2)("rowspan",1),s.xp6(2),s.hij("Categoria: ",i.subasta.products.categorias,""),s.xp6(1),s.Q6J("ngIf",i.finalizarCompra),s.xp6(1),s.Q6J("colspan",4)("rowspan",1),s.xp6(1),s.Q6J("colspan",4)("rowspan",1),s.xp6(2),s.hij("Descripcion: ",i.subasta.products.descripcion,""))},directives:[u,q,Z._Y,Z.JL,Z.sg,F,$,L.hX,Z.wV,Z.Fj,Z.JJ,Z.u,N.lW,a.O5],styles:[V]}),t})(),K=(()=>{class t{constructor(t,i,e,a,r,s,o,n){this.subastaService=t,this.router=i,this.dialogRef=e,this.data=a,this.snackBar=r,this.auth=s,this.orderService=o,this.OrderService=n,this.form=new Z.cw({ciudad:new Z.NI("",Z.kI.required),direccion1:new Z.NI("",Z.kI.required),direccion2:new Z.NI("",Z.kI.required),opcion:new Z.NI("",Z.kI.required)})}ngOnInit(){}finalizar(){var t=this;return(0,w.Z)(function*(){if(console.log("Opcion: "+t.form.value.opcion),""==t.form.value.ciudad||""==t.form.value.direccion1||""==t.form.value.direccion2||""==t.form.value.opcion)t.snackBar.open("Debe completar el formulario!","Ok",{duration:2e3});else{let i={user:t.auth.currentUser[0]._id,shipping:{name:t.auth.currentUser[0].nombre+" "+t.auth.currentUser[0].apellido,city:t.form.value.ciudad,addressLine1:t.form.value.direccion1,addressLine2:t.form.value.direccion2},items:t.data.producto,tipo:t.form.value.opcion,estado:"Env\xedo"==t.form.value.opcion?"Pedido realizado":"En Tienda"};t.data.producto.precio=t.data.precio;const e={_id:t.data.subasta._id,propietario:t.data.subasta.propietario._id,usuarios:t.auth.currentUser[0]._id,products:t.data.subasta.products._id,estado:"Inactiva",oferta:t.form.value.oferta,fecha_final:t.data.subasta.fecha_final};yield t.subastaService.putSubasta(e).toPromise(),t.snackBar.open("Orden generada con \xe9xito!","Ok",{duration:2e3}),t.dialogRef.close();let a=yield t.orderService.postOrder(i).toPromise();if("En Tienda"==t.form.value.opcion){let i={name:t.auth.currentUser[0].nombre,lastName:t.auth.currentUser[0].apellido,address1:t.form.value.direccion1,address2:t.form.value.direccion2,orderID:a._id,total:t.data.precio,items:[t.data.producto],correo:t.auth.currentUser[0].correo};yield t.OrderService.postEmail(i).toPromise(),t.snackBar.open("Se ha enviado el correo con \xe9xito!","Ok",{duration:3500})}t.router.navigate(["/order-success",a._id])}})()}}return t.\u0275fac=function(i){return new(i||t)(s.Y36(c.q),s.Y36(r.F0),s.Y36(h.so),s.Y36(h.WI),s.Y36(v.ux),s.Y36(o.e),s.Y36(D.p),s.Y36(D.p))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-mensaje"]],decls:23,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"mat-typography"],[3,"formGroup"],["matInput","","type","text","formControlName","ciudad","required","",1,"form-control",2,"margin-top","15px","margin-bottom","15px","width","260px"],["matInput","","type","text","formControlName","direccion1","required","",1,"form-control",2,"margin-top","15px","margin-bottom","15px","width","260px"],["matInput","","type","text","formControlName","direccion2","required","",1,"form-control",2,"margin-top","15px","margin-bottom","15px","width","260px"],["aria-label","Select an option","formControlName","opcion","required","",1,"example-radio-group"],["value","Env\xedo",1,"example-radio-button"],["value","En Tienda",1,"example-radio-button"],["mat-dialog-actions","","align","end"],["mat-button","","color","primary",2,"margin-top","15px",3,"click"]],template:function(t,i){1&t&&(s.TgZ(0,"h1",0),s._uU(1,"Finalizar Orden"),s.qZA(),s.TgZ(2,"div",1),s.TgZ(3,"form",2),s.TgZ(4,"h3"),s._uU(5,"Ciudad"),s.qZA(),s._UZ(6,"input",3),s.TgZ(7,"h3"),s._uU(8,"Direcci\xf3n 1"),s.qZA(),s._UZ(9,"input",4),s.TgZ(10,"h3"),s._uU(11,"Direcci\xf3n 2"),s.qZA(),s._UZ(12,"input",5),s.TgZ(13,"h3"),s._uU(14,"Tipo de Env\xedo"),s.qZA(),s.TgZ(15,"mat-radio-group",6),s.TgZ(16,"mat-radio-button",7),s._uU(17,"Delivery"),s.qZA(),s.TgZ(18,"mat-radio-button",8),s._uU(19,"Retiro en Punto"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(20,"div",9),s.TgZ(21,"button",10),s.NdJ("click",function(){return i.finalizar()}),s._uU(22,"Finalizar Orden"),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("formGroup",i.form))},directives:[h.uh,h.xY,Z._Y,Z.JL,Z.sg,Z.Fj,Z.JJ,Z.u,Z.Q7,G.VQ,G.U0,h.H8,N.lW],styles:[V]}),t})();const tt=[{path:"",component:x,children:[]},{path:"producto",component:W,children:[]}];let it=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[r.Bz.forChild(tt)],r.Bz]}),t})(),et=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[a.ez,it,k,j,L.lN,Z.UX,Z.u5,N.ot,v.ZX,h.Is,G.Fk]]}),t})()}}]);